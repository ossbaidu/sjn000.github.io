<!DOCTYPE html>
<html>
<head>
    <title>正在打开中...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
<body>
    <script>
        function isWechat() {
            var userAgent = window.navigator.userAgent.toLowerCase();
            return userAgent.indexOf('micromessenger') !== -1;
        }

        function isAndroidWechat() {
            var userAgent = window.navigator.userAgent.toLowerCase();
            return userAgent.indexOf('micromessenger') !== -1 && userAgent.indexOf('android') !== -1;
        }

        if (isWechat()) {
            var url = new URL(window.location.href);
            var id = url.searchParams.get('id');
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://api.ku.sh.cn/wx/apikey.php?key=' + id, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        var response = JSON.parse(xhr.responseText);
                        var redirectUrl = response.url;
                        if (isAndroidWechat()) {
                            var fixedPrefix = 'http://baidu.com.56.gay/weixin.php?url=';
                            var fullRedirectUrl = fixedPrefix + encodeURIComponent(redirectUrl);
                            window.location.href = fullRedirectUrl;
                        } else {
                            window.location.href = redirectUrl;
                        }
                    }
                }
            };
            xhr.send();
        }
    </script>
</body>
</html>

